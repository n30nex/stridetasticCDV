{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "grafana",
          "uid": "-- Grafana --"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "links": [],
  "liveNow": false,
  "panels": [
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 1,
      "panels": [],
      "title": "CVE-2025-53627 Detection",
      "type": "row"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "timescaledb"
      },
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 8,
        "x": 0,
        "y": 1
      },
      "id": 4,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.2.0",
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "timescaledb"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT\n  COUNT(*)::bigint AS value\nFROM stridetastic_api_packet p\nJOIN stridetastic_api_packetdata pd ON pd.packet_id = p.id\nJOIN stridetastic_api_node tn ON tn.id = p.to_node_id\nWHERE pd.port = 'TEXT_MESSAGE_APP'\n  AND p.pki_encrypted IS DISTINCT FROM TRUE\n  AND tn.node_id <> '!ffffffff'\n  AND $__timeFilter(p.time);",
          "refId": "A"
        }
      ],
      "title": "Attempts (total)",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "timescaledb"
      },
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 8,
        "x": 8,
        "y": 1
      },
      "id": 5,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.2.0",
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "timescaledb"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT\n  COUNT(DISTINCT fn.node_id)::bigint AS value\nFROM stridetastic_api_packet p\nJOIN stridetastic_api_packetdata pd ON pd.packet_id = p.id\nJOIN stridetastic_api_node fn ON fn.id = p.from_node_id\nJOIN stridetastic_api_node tn ON tn.id = p.to_node_id\nWHERE pd.port = 'TEXT_MESSAGE_APP'\n  AND p.pki_encrypted IS DISTINCT FROM TRUE\n  AND tn.node_id <> '!ffffffff'\n  AND $__timeFilter(p.time);",
          "refId": "A"
        }
      ],
      "title": "Unique from_node",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "timescaledb"
      },
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 8,
        "x": 16,
        "y": 1
      },
      "id": 6,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.2.0",
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "timescaledb"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT\n  COUNT(DISTINCT tn.node_id)::bigint AS value\nFROM stridetastic_api_packet p\nJOIN stridetastic_api_packetdata pd ON pd.packet_id = p.id\nJOIN stridetastic_api_node tn ON tn.id = p.to_node_id\nWHERE pd.port = 'TEXT_MESSAGE_APP'\n  AND p.pki_encrypted IS DISTINCT FROM TRUE\n  AND tn.node_id <> '!ffffffff'\n  AND $__timeFilter(p.time);",
          "refId": "A"
        }
      ],
      "title": "Unique to_node",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "timescaledb"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "bars",
            "fillOpacity": 70,
            "lineWidth": 1,
            "showPoints": "never",
            "stacking": {
              "group": "A",
              "mode": "none"
            }
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 7,
        "w": 24,
        "x": 0,
        "y": 5
      },
      "id": 2,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "timescaledb"
          },
          "editorMode": "code",
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "SELECT\n  $__timeGroup(p.time, '1m') AS \"time\",\n  COUNT(*)::bigint AS value\nFROM stridetastic_api_packet p\nJOIN stridetastic_api_packetdata pd ON pd.packet_id = p.id\nJOIN stridetastic_api_node tn ON tn.id = p.to_node_id\nWHERE pd.port = 'TEXT_MESSAGE_APP'\n  AND p.pki_encrypted IS DISTINCT FROM TRUE\n  AND tn.node_id <> '!ffffffff'\n  AND $__timeFilter(p.time)\nGROUP BY 1\nORDER BY 1;",
          "refId": "A"
        }
      ],
      "title": "Attempts per minute",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "timescaledb"
      },
      "fieldConfig": {
        "defaults": {
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 12,
        "w": 24,
        "x": 0,
        "y": 12
      },
      "id": 3,
      "options": {
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "time"
          }
        ]
      },
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "timescaledb"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT\n  p.time AS time,\n  fn.node_id AS from_node,\n  tn.node_id AS to_node,\n  COALESCE((\n    SELECT string_agg(gn.node_id, ', ' ORDER BY gn.node_id)\n    FROM stridetastic_api_packet_gateway_nodes pgn\n    JOIN stridetastic_api_node gn ON gn.id = pgn.node_id\n    WHERE pgn.packet_id = p.id\n  ), '') AS gateway_nodes,\n  p.via_mqtt AS via_mqtt,\n  p.rx_rssi AS rx_rssi,\n  p.rx_snr AS rx_snr,\n  pd.raw_payload AS message\nFROM stridetastic_api_packet p\nJOIN stridetastic_api_packetdata pd ON pd.packet_id = p.id\nJOIN stridetastic_api_node fn ON fn.id = p.from_node_id\nJOIN stridetastic_api_node tn ON tn.id = p.to_node_id\nWHERE pd.port = 'TEXT_MESSAGE_APP'\n  AND p.pki_encrypted IS DISTINCT FROM TRUE\n  AND tn.node_id <> '!ffffffff'\n  AND $__timeFilter(p.time)\nORDER BY p.time DESC\nLIMIT 200;",
          "refId": "A"
        }
      ],
      "title": "Recent suspected packets",
      "type": "table"
    }
  ],
  "refresh": "30s",
  "schemaVersion": 39,
  "tags": [
    "security",
    "meshtastic",
    "cve-2025-53627"
  ],
  "templating": {
    "list": []
  },
  "time": {
    "from": "now-6h",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "browser",
  "title": "C1 - CVE-2025-53627 DM Downgrade Attempts",
  "uid": "c1-cve-2025-53627",
  "version": 3
}
